<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="吴晓龙" type="application/atom+xml">






<meta name="description" content="耐得住寂寞 守得住繁华">
<meta property="og:type" content="website">
<meta property="og:title" content="吴晓龙">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="吴晓龙">
<meta property="og:description" content="耐得住寂寞 守得住繁华">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="吴晓龙">
<meta name="twitter:description" content="耐得住寂寞 守得住繁华">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>吴晓龙</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">吴晓龙</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">爱吃哈密瓜的程序员</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-search">
          <a href="/search" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            搜索
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            日程表
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/commonweal" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/11/滴滴/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="吴晓龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://opq81riyh.bkt.clouddn.com/666.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓龙">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/11/滴滴/" itemprop="url">滴滴</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-11T11:12:26+08:00">
                2019-01-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="滴滴"><a href="#滴滴" class="headerlink" title="滴滴"></a>滴滴</h1><p>标签（空格分隔）： interview</p>
<hr>
<h3 id="java"><a href="#java" class="headerlink" title="java"></a>java</h3><p>1、四中引用的区别：强引用、软引用、弱引用、虚引用<br>2、String、StringBuffer与StringBuilder之间区别<br>3、String a = “AB”, String b = “A” + “B”,Sting c = new String(“AB”)<br>这三个是否相等，为什么？<br>4、java中的线程池，核心参数，怎么处理的<br>5、AsyncTask是线程池吗？大概流程，线程池怎么创建的，核心参数怎么定的,线程怎么切换的，rannable和callable的区别。<br>6、多线程同步，volatile。单例为什么要保证volatile？和syncronized有什么区别？java虚拟机中多线程怎么对变量进行读取的？<br>7、thradlocal的原理，key是什么？<br>8、hashmap的数据结构？树是什么树？hashmap在多线程有什么问题？<br>9、lrucache？linkedHashmap？<br>10、sparseArray？查找怎么查找？复杂度？hashmap不考虑hash冲突时间复杂度是多少？<br>11、迭代器遍历和for循环遍历有什么区别？</p>
<h3 id="android"><a href="#android" class="headerlink" title="android"></a>android</h3><p>1、okhttp原理，call对象是什么？realcall是普通类？有几个拦截器，都有哪些？okio原理？怎么处理缓存，缓存机制，怎么判断缓存过期?<br>线程池？<br>2、retrofit？核心思想是什么？<br>3、rxjava<br>4、intentservice，handlerthread跟普通thread有什么区别？<br>5、handler中post(rannable)和sendmessage有什么区别？looper从哪里取rannable？looper取消息是死循环吗？looper为什么不会阻塞用户操作，界面渲染，卡死主线程？handler在子线程创建有什么问题？主线程为什么不用创建？<br>6、oom都有哪些场景？讲一下内存泄漏？怎么解决内存泄漏？leakcanary怎么检测到内存泄漏的？<br>7、如何定义一个对象可以被回收？有哪些可以作为gcroot的节点？<br>8、jvm回收的算法？新生代假如内存没满不配置，一定是15次吗？都有哪些算法（标记整理，复制，标记清除）？major gc和full gc有什么区别？<br>9、android中自定义view的核心方法？canvas和paint分别是干嘛的？<br>10、onmeasure中有哪些测量模式？<br>11、android性能优化分别做了哪些？过度渲染怎么判断？怎么避免？<br>12、recylerview滑动到item，怎么保证滑动到的时候手松开，保证显示的是完整的item？<br>13、git rebase 和merge区别？<br>14、http三次握手，为什么需要三次？四次挥手，为什么需要四次？<br>15、http常见的header有哪些？charles<br>16、什么是AOP？</p>
<h3 id="滴滴二面"><a href="#滴滴二面" class="headerlink" title="滴滴二面"></a>滴滴二面</h3><p>1、做android开发多久了？做过日志系统，怎么做的？<br>2、你清楚android事件传递流程吗？<br>3、blockcanary怎么做的？有现成的为什么还要自己再封装一个？looper和handler的关系？handlermessage有一部分是c实现的，native代码做什么用的，功能是什么，作用是什么？<br>4、解决过重构中的难题？是什么样的难题？<br>5、app启动的时候数据比较多的时候会比较慢，怎么解决这个问题的？（数据库比较大的时候，怎么解决启动速度），通常优化查询速度怎么做的？（一次读入大量数据，查询性能怎么做的），能用int不用string原理是什么？groupby会用吗？like，搜索词做不做预处理？做一次查询最长的是多长？没有对sqllite做过优化吗？当sql数据变得越来越多的时候怎么处理？几个db？拆表的目的是什么？拆数据库的目的是什么？数据库大了后启动速度变慢怎么解决？<br>6、从ui上怎么做启动优化的？两个activity之间跳转的时间节省多少？viewstub？<br>7、intentServise？了解跨进程吗？aidl原理？Binder原理？Binder的优点是什么？socekt为什么需要两次？<br>8、我如何画一条虚线？paint设置什么属性？还有别的实现方式吗？shape了解过吗？<br>9、怎么写一个自定义view？并且把view的属性暴露给xml用？怎么定义一个自定义view的主题（theme）？</p>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/09/两数之和3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="吴晓龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://opq81riyh.bkt.clouddn.com/666.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓龙">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/09/两数之和3/" itemprop="url">两数之和3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-09T09:19:30+08:00">
                2019-01-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="数组三：两数之和"><a href="#数组三：两数之和" class="headerlink" title="数组三：两数之和"></a>数组三：两数之和</h1><p>标签（空格分隔）： 数据结构</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">package array;</span><br><span class="line"></span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Iterator;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 两数之和丨丨丨</span><br><span class="line">* 设计一个类.包含如下两个成员函数：</span><br><span class="line">* Save(int input)</span><br><span class="line">* 插入一个整数到一个整数集合里。</span><br><span class="line">* Test(int target)</span><br><span class="line">* 检验是否存在两个数和为输入值。如果存在这两个数. 则返回 true; 否则返回 false。</span><br><span class="line">*</span><br><span class="line">*</span><br><span class="line">*/</span><br><span class="line">public class TwoSum &#123;</span><br><span class="line">static HashMap&lt;Integer,Integer&gt; hashMap = new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">public static void save(int input) &#123;</span><br><span class="line">Integer integer = hashMap.get(input);</span><br><span class="line">if (integer != null) &#123;</span><br><span class="line">hashMap.put(input,integer++);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">hashMap.put(input,1);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static boolean test(int target) &#123;</span><br><span class="line">Iterator&lt;Integer&gt; iterator = hashMap.keySet().iterator();</span><br><span class="line">while (iterator.hasNext()) &#123;</span><br><span class="line">Integer next = iterator.next();</span><br><span class="line">if (hashMap.containsKey(target - next) ) &#123;</span><br><span class="line">//需要判断是否有这种特殊情况</span><br><span class="line">boolean isDouble = target == next * 2;</span><br><span class="line">//排除同一个数是要找的和的一半，并且只有一个，如果这个数存储了两个那也是满足情况的</span><br><span class="line">if (!(isDouble &amp;&amp; hashMap.get(next) == 1)) &#123;</span><br><span class="line">return true;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">return false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/08/两数之和2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="吴晓龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://opq81riyh.bkt.clouddn.com/666.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓龙">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/08/两数之和2/" itemprop="url">两数之和2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-08T10:12:14+08:00">
                2019-01-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="数组二：两数之和"><a href="#数组二：两数之和" class="headerlink" title="数组二：两数之和"></a>数组二：两数之和</h1><p>标签（空格分隔）： 数据结构</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">package array;</span><br><span class="line"></span><br><span class="line">import java.util.HashMap;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 两数 之 和 II</span><br><span class="line">*</span><br><span class="line">* 给定一个整型的数组. 找出其中的两个数使其和为某个指定的值，</span><br><span class="line">* 并返 回这两个数的下标（数组下标是从〇开始)。假设数组元素的值各不相同.</span><br><span class="line">* 则要求时间复杂度为〇(n). n 为数组的长度。</span><br><span class="line">*/</span><br><span class="line">public class Test02 &#123;</span><br><span class="line">public static int[] twoSum(int[] arr, int target) &#123;</span><br><span class="line">int[] res = &#123;-1,-1&#125;;</span><br><span class="line">if (arr == null || arr.length &lt; 2) &#123;</span><br><span class="line">return  res;</span><br><span class="line">&#125;</span><br><span class="line">HashMap&lt;Integer, Integer&gt; hashMap = new HashMap&lt;&gt;();</span><br><span class="line">for (int i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">//扫描一遍，存储值与下标</span><br><span class="line">hashMap.put(arr[i],i);</span><br><span class="line">&#125;</span><br><span class="line">for (int i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">//不能出现同一个数的两倍是target</span><br><span class="line">if (hashMap.containsKey(target - arr[i]) &amp;&amp; target != 2 * arr[i]) &#123;</span><br><span class="line">//获取结果的两个下标</span><br><span class="line">res[0] = arr[i];</span><br><span class="line">res[1] = hashMap.get(target - arr[i]);</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/08/两数之和/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="吴晓龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://opq81riyh.bkt.clouddn.com/666.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓龙">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/08/两数之和/" itemprop="url">两数之和</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-08T09:09:34+08:00">
                2019-01-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="数组一：两数之和"><a href="#数组一：两数之和" class="headerlink" title="数组一：两数之和"></a>数组一：两数之和</h1><p>标签（空格分隔）： 数据结构</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">package array;</span><br><span class="line"></span><br><span class="line">import java.util.Arrays;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 面 试 题 1 : 两数之和</span><br><span class="line"> *</span><br><span class="line"> * 给定一个整型数组，是否能找出其中的两个数使其和为某个指定的值?</span><br><span class="line"> *</span><br><span class="line"> *</span><br><span class="line"> * 举例</span><br><span class="line"> * 输入数组为&#123;1，5, 7, 3&#125;以及指定的目标值为10,我们可以从中找出两个数3 和 7, 和 为 10。</span><br><span class="line"> *</span><br><span class="line"> *</span><br><span class="line"> * 通过排序让复杂度降至O(n*logn)</span><br><span class="line"> */</span><br><span class="line">public class Test01 &#123;</span><br><span class="line"></span><br><span class="line">    public static boolean hasSum(int[] arr, int target) &#123;</span><br><span class="line">        boolean res = false;</span><br><span class="line">        //参数校验</span><br><span class="line">        if (arr == null || arr.length &lt; 2) &#123;</span><br><span class="line">            return res;</span><br><span class="line">        &#125;</span><br><span class="line">        //对数组排序</span><br><span class="line">        Arrays.sort(arr);</span><br><span class="line">        int left = 0;</span><br><span class="line">        int right = arr.length -1;</span><br><span class="line">        while (left != right) &#123;</span><br><span class="line">           int sum =  arr[left] + arr[right];</span><br><span class="line">           if (sum &gt; target) &#123; //目标值过小，向前移动尾部指针，减小两数之和</span><br><span class="line">               right --;</span><br><span class="line">           &#125; else if (sum &lt; target) &#123;//目标值过大，向后移动头部指针，增加两数之和</span><br><span class="line">               left ++;</span><br><span class="line">           &#125; else &#123;</span><br><span class="line">               res = true;</span><br><span class="line">               break;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/24/学习心得/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="吴晓龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://opq81riyh.bkt.clouddn.com/666.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓龙">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/24/学习心得/" itemprop="url">学习心得</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-24T16:22:47+08:00">
                2018-07-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#以前觉得看视频学得快，其实真正获取知识还是要自己去思考</p>
<p>标签（空格分隔）： 系统的静下心来学习</p>
<hr>
<p>系统的学习；<br>不沉迷于打广告挣外快；<br>有计划的学习；<br>锻炼抗压能力。<br>更有效的学习。<br>不跟随别人脚步，按照自己心意来；</p>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/08/Android-应用工程师的-Binder-原理剖析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="吴晓龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://opq81riyh.bkt.clouddn.com/666.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓龙">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/08/Android-应用工程师的-Binder-原理剖析/" itemprop="url">Android 应用工程师的 Binder 原理剖析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-08T20:33:02+08:00">
                2018-05-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/解析/" itemprop="url" rel="index">
                    <span itemprop="name">解析</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Android-应用工程师的-Binder-原理剖析"><a href="#Android-应用工程师的-Binder-原理剖析" class="headerlink" title="Android 应用工程师的 Binder 原理剖析"></a>Android 应用工程师的 Binder 原理剖析</h1><p>标签（空格分隔）： Binder</p>
<hr>
<p>##一、Binder概述</p>
<h3 id="Binder是一种进程间通信机制，基于开源的OpenBinder实现（http-www-angryredplanet-com-hackbod-openbinder-docs-html-）"><a href="#Binder是一种进程间通信机制，基于开源的OpenBinder实现（http-www-angryredplanet-com-hackbod-openbinder-docs-html-）" class="headerlink" title="Binder是一种进程间通信机制，基于开源的OpenBinder实现（http://www.angryredplanet.com/~hackbod/openbinder/docs/html/）"></a>Binder是一种进程间通信机制，基于开源的OpenBinder实现（<a href="http://www.angryredplanet.com/~hackbod/openbinder/docs/html/）" target="_blank" rel="noopener">http://www.angryredplanet.com/~hackbod/openbinder/docs/html/）</a></h3><h3 id="1、为什么必须理解Binder？"><a href="#1、为什么必须理解Binder？" class="headerlink" title="1、为什么必须理解Binder？"></a>1、为什么必须理解Binder？</h3><ol>
<li>为什么Activity间传递对象需要序列化？</li>
<li>Activity的启动流程是什么样？</li>
<li>四大组件底层的通信机制是怎么样的？</li>
<li>AIDL内部的实现原理是什么？</li>
<li>插件化编程技术应该从何学起？</li>
<li>…</li>
</ol>
<h4 id="要弄清楚上面一系列问题，就必须先理解Binder通信机制。"><a href="#要弄清楚上面一系列问题，就必须先理解Binder通信机制。" class="headerlink" title="要弄清楚上面一系列问题，就必须先理解Binder通信机制。"></a>要弄清楚上面一系列问题，就必须先理解Binder通信机制。</h4><h4 id="Activity、Service、Broadcast-Receiver、Content-Provider四大组件有时运行在不同进程，进程间通信依赖于Binder-IPC机制。"><a href="#Activity、Service、Broadcast-Receiver、Content-Provider四大组件有时运行在不同进程，进程间通信依赖于Binder-IPC机制。" class="headerlink" title="Activity、Service、Broadcast Receiver、Content Provider四大组件有时运行在不同进程，进程间通信依赖于Binder IPC机制。"></a>Activity、Service、Broadcast Receiver、Content Provider四大组件有时运行在不同进程，进程间通信依赖于Binder IPC机制。</h4><h4 id="Android系统对应用层提供的各种服务：-ActivityManagerService、PackageManagerService等都是基于Binder-IPC机制实现。"><a href="#Android系统对应用层提供的各种服务：-ActivityManagerService、PackageManagerService等都是基于Binder-IPC机制实现。" class="headerlink" title="Android系统对应用层提供的各种服务： ActivityManagerService、PackageManagerService等都是基于Binder IPC机制实现。"></a>Android系统对应用层提供的各种服务： ActivityManagerService、PackageManagerService等都是基于Binder IPC机制实现。</h4><h3 id="2、Android系统为什么用Binder？"><a href="#2、Android系统为什么用Binder？" class="headerlink" title="2、Android系统为什么用Binder？"></a>2、Android系统为什么用Binder？</h3><p>####Android系统基于Linux内核，Linux已经提供了管道、消息队列、共享内存和Socket等IPC机制。为什么Android还要提供Binder来实现IPC? </p>
<p>详细请参考知乎：<br><a href="https://www.zhihu.com/question/39440766?sort=created" target="_blank" rel="noopener">为什么Android要采用Binder作为IPC机制?</a><br><a href="https://www.cnblogs.com/bastard/archive/2012/10/17/2728155.html" target="_blank" rel="noopener">Android为什么选择binder</a></p>
<h4 id="对比Linux进程间IPC方式："><a href="#对比Linux进程间IPC方式：" class="headerlink" title="对比Linux进程间IPC方式："></a>对比Linux进程间IPC方式：</h4><ol>
<li>管道：在创建时分配一个page大小的内存，缓存区大小比较有限；</li>
<li>消息队列：信息复制两次，额外的CPU消耗；不适合频繁或信息量大的通信；</li>
<li>共享内存：无需复制，共享缓冲区直接附加到进程虚拟地址空间，速度快；但进程间的同步问题操作系统无法实现，必须各进程利用同步工具解决；</li>
<li>套接字：作为更通用的接口，传输效率低，主要用于不同机器或跨网络的通信；</li>
<li>信号量：常作为一种锁机制，防止某进程正在访问共享资源时，其他进程也访问该资源。因此，主要作为进程间以及同一进程内不同线程之间的同步手段。</li>
<li>信号：不适用于信息交换，更适用于进程中断控制，比如非法内存访问，杀死某个进程等；</li>
</ol>
<h4 id="主要是："><a href="#主要是：" class="headerlink" title="主要是："></a>主要是：</h4><ul>
<li>性能：数据拷贝次数：Binder数据拷贝只需要一次，而管道、消息队列、Socket都需要两次，但共享内存方式一次内存拷贝都不需要；从性能角度看，Binder性能仅次于共享内存。</li>
<li>稳定性：Binder是基于C/S架构的(客户端Client和服务端Server组成架构，Client端有什么需求，直接发送给Server端去完成，架构清晰明朗，Server端与Clent端相对独立，稳定性较好)；而共享内存实现方式复杂，没有客户与服务端之别，需要充分考虑到访问临界资源的并发同步问题，否则可能会出现死锁等问题；从稳定性角度看，Binder架构优越于共享内存。</li>
<li>安全性：传统Linux IPC的接收方无法获得对方进程可靠的UID/PID,从而无法鉴别对方身份；而Android作为一个开放的开源体系，拥有非常多的开发平台，App开源甚广，因此手机的安全显得额外重要；对于普通用户，绝不希望从App商店下载偷窥隐私数据、后台造成手机耗电等等问题，传统的Linux IPC无任何保护措施，完全由上层协议来确保。Android为每个按照你黄浩的APp分配了自己的UID，故而进程的UID是鉴别金恒身份的重要标志。传统的IPC只能由用户在数据包中填入UID/PID，但这样不可靠，容易被恶意程序利用。可靠的身份标识只有由IPC机制在内核在内核中添加。其次传统的IPC访问接入点是开放的，只要知道这些接入点的程序都可以和对端建立连接，不管怎样都无法阻止恶意程序通过猜测接收方地址获得连接。同时Binder既支持实名Binder，又支持匿名Binder，安全性高。</li>
</ul>
<p>##二、Linux下传统的进程间通信原理</p>
<p><img src="http://ocjtywvav.bkt.clouddn.com/blog/android/binder/linux_ipc_1.png" alt="Linux背景知识"></p>
<p><img src="http://ocjtywvav.bkt.clouddn.com/blog/android/binder/linux_ipc_2.png" alt="传统IPC通信原理"></p>
<ul>
<li>进程隔离 </li>
</ul>
<p>进程与进程间内存是不共享的。两个进程就像两个平行的世界，A进程没法直接访问B进程的数据，A进程和B进程之间要进行数据交互就得采用特殊的通信机制：进程间通信（IPC）。</p>
<ul>
<li>进程空间划分</li>
</ul>
<p>操作系统给的核心是内核，独立于普通的应用程序，可以访问受保护的内存空间，也可以访问底层硬件设备。为了保护用户进程不能直接操作内核，保证内核的安全，操作系统刚从落机上将虚拟空间划分为用户空间（User Space）和内核空间（Kernel Space）。简单说，内核空间（Kernel）是系统内核运行的空间，用户空间（User Space）是用户程序运行的空间。为了保证安全性，他们之间是隔离的。</p>
<ul>
<li>系统调用</li>
</ul>
<p>虽然从逻辑上进行了用户空间和内核空间的划分，但不可避免的用户空间需要访问内核资源，比如文件操作，网络访问等。为了突破隔离限制，就需要借助系统调用来实现。系统调用是用户空间访问内核空间的唯一方式，保证了所有的资源访问都是在内核的控制下进行，避免用户程序对系统资源的越权访问，提升系统安全性和稳定性。</p>
<p>系统调用主要通过如下两个函数实现：<br>copy_from_user()//将数据从用户空间拷贝到内核空间<br>copy_to_user()//将数据从内核空间拷贝到用户空间</p>
<p>通常的做法是消息发送方将要发送的数据存放在内存缓存区中，通过系统调用进入内核态。然后内核程序在内核空间分配内存，开辟一块内核缓存区，调用copy_from_user()函数将数据从用户空间的内存缓存区拷贝到内和空间的内存缓存区中。同样的，接收方进程在接收数据时在自己的用户空间开辟一块内存缓存区，然后内核程序调用copy_to_user()函数将数据从内核缓存区起拷贝到接收进程的内存缓存区。这样数据发送方进程和数据接收方进程就完成了一次数据传输，我们称完成了一次进程间通信。</p>
<p>####传统的IPC通信方式有两个问题：<br>1、性能低下,一次数据传递需要经历：内存缓存区–&gt;内存缓存区–&gt;内存缓存区，需要2次数据拷贝；<br>2、接收数据的缓存区由数据接收进程提供，但是接收进程并不知道需要多大的空间来存放将要传递过来的数据，因此只能开辟尽可能打的内存空间或者先调用API接收消息来获取消息体的大小，这两种做法不是浪费空间就是浪费时间。</p>
<p>##三、Binder跨进程通信原理<br><a href="https://blog.csdn.net/boyupeng/article/details/47011383" target="_blank" rel="noopener">Android Binder机制原理（史上最强理解，没有之一）</a></p>
<ol>
<li>动态内核可加载模块 &amp;&amp; 内存映射</li>
</ol>
<p>Binder并不是Linux的内核，得益于Linux的动态内核可加载模块（Loadable Kernel Module,LKM）机制；模块是具有独立功能的程序，它可以被单独编译，但是不能独立运行。它在运行时被连接到内核作为内核的一部分运行。这样，Android系统就可以通过动态添加一个内核模块运行在内核空间，用户进程之间通过这个内核模块作为桥梁来实现通信。</p>
<p>在Android系统中，这个运行在内核空间，负责各个用户进程通过Binder实现通信的内核模块就叫Binde驱动（Binder Driver）。</p>
<p>内存映射：Binder IPC机制中涉及到的内存映射通过mmap（）实现，mmap（）是操作系统中的一种内存映射的方法。内存映射简单的将就是讲用户空间的一块内存区域映射到内核空间。映射关系建立后，用户对这块内存区域的修改可以直接反应到内核空间；反之内核空间对这段区域的修改也能直接反应到用户空间。</p>
<p>内存映射能减少数据拷贝次数，实现用户空间和内和空间的高效互动。两个空间各自的修改能直接反映在映射的内存区域，从而被对方空间及时感知。也正因为如此，内存映射能够提供对进程间通信的支持。</p>
<ol>
<li>Binder IPC实现原理</li>
</ol>
<p>Binder IPC正是基于内存映射（mmpc）来实现的，但是mmap（）通常是在有物理截止的文件系统上的。<br>比如进程中的用户区域是不能直接和物理设备打交道的，如果想把磁盘上的数据读取到进程的用户区域，需要两次拷贝（磁盘–&gt;内核空间–&gt;用户空间）；通常在这种场景下mmap（）就能发挥作用，通过在物理介质和用户空间之间建立映射，减少数据的拷贝次数，用内存读写取代I/O读写，提价文件读取效率。</p>
<p>而Binder并不存在物理介质，因此Binder驱动使用mmap（）并不是为了在物理介质和用户空间之间建立映射，而是用来在内核空间创建数据接收的缓存空间。</p>
<h4 id="一次完整的Binder-IPC-通信过程通常是这样："><a href="#一次完整的Binder-IPC-通信过程通常是这样：" class="headerlink" title="一次完整的Binder IPC 通信过程通常是这样："></a>一次完整的Binder IPC 通信过程通常是这样：</h4><ol>
<li>首先Binder驱动在内核空间创建一个数据接收缓存区；</li>
<li>接着在内核空间开辟一块内核缓存区，建立内核缓存区和内核中数据接收缓存区之间的映射关系，以及内核中数据接收缓存区和接收进程用户空间地址的映射关系。</li>
<li>发送方进程通过系统调用copy_from_user()将数据copy到内核中的内核缓存区，由于内核缓存区和接收进程的用户空间存在内存映射，因此也就相当于把数据发送到了接收进程的用户空间，这样便完成了一次进程间的通信。</li>
</ol>
<p><img src="http://ocjtywvav.bkt.clouddn.com/blog/android/binder/binder_ipc_1.png" alt="Binder IPC原理"></p>
<p>##四、Binder通信模型</p>
<p>一次完整的进程间通信必然至少包含两个进程，通常我们称通信的双方分别为客户端进程（Client）和服务端进程（Server），由于进程隔离机制的存在，通信双方必然需要借助Binder来实现。</p>
<h3 id="Clent-Server-ServerManager-驱动"><a href="#Clent-Server-ServerManager-驱动" class="headerlink" title="Clent/Server/ServerManager/驱动"></a>Clent/Server/ServerManager/驱动</h3><p>Binder由Clent，Server、ServerManager、Binder驱动一系列组件组成。其中Clent、Server、ServerManager运行在用户空间，Binder驱动运行在内核空间。其中ServerManager和Binder驱动由系统提供，而Clent、Server由应用程序来实现。Clent、Server和ServerManager均是通过系统调用open、mmap和ioctl来访问设备文件/dev/binder，从而实现与Binder驱动的交互来间接的实现跨进程通信。</p>
<p><img src="http://ocjtywvav.bkt.clouddn.com/blog/android/binder/binder_ipc_2.png" alt="通信模型"></p>
<h3 id="Binder通信过程"><a href="#Binder通信过程" class="headerlink" title="Binder通信过程"></a>Binder通信过程</h3><ol>
<li>首先，一个进程使用BINDER_SET_CONTEXT_MGR命令通过Binder驱动将自己注册成为ServiceManager；</li>
<li>Server通过驱动向ServiceManager中注册Binder（Server中的Binder实体）驱动为这个Binder创建位于内核中的实体节点以及ServiceManager对实体的引用，将名字以及新建的引用打包传给ServiceManager，ServiceManager将其填入查找表。</li>
<li>Clent通过名字，在Binder驱动的帮助下从ServiceManager中获取到对Binder实体的引用，通过这个引用就能实现和Server进程的通信。</li>
</ol>
<p>整个通信过程都需要Binder驱动的接入，</p>
<p><img src="http://ocjtywvav.bkt.clouddn.com/blog/android/binder/binder_ipc_4.png" alt="Binder通信模型"></p>
<h3 id="Binder通信中的代理模式"><a href="#Binder通信中的代理模式" class="headerlink" title="Binder通信中的代理模式"></a>Binder通信中的代理模式</h3><p>A进程想要B进程中某个对象如何实现？</p>
<p>数据流经Binder驱动的时候驱动会对数据做一层转换。当A进程想要获取B进程中的object时，驱动并不会真的把object返回给A，而是返回一个跟object一抹一眼的代理对象objectProxy，这个objectProxy具有和object一模一样的方法，但是这些方法并没有B进程找那个object对象那些方法的能力，这些方法只需要把请求参数交给驱动即可。</p>
<p>当驱动接收到A进程的消息后，发现这个objectProxy就去查询自己维护的表单，一查发现这是B进程object的代理对象。于是就会通知B进程调用object的方法，并要求B进程把结果发给自己。的那个驱动霸道B进程的返回结果后就会转发给A进程，一次通信及完成了。</p>
<p><img src="http://ocjtywvav.bkt.clouddn.com/blog/android/binder/binder_ipc_5.png" alt=""></p>
<h3 id="Binder的完整定义"><a href="#Binder的完整定义" class="headerlink" title="Binder的完整定义"></a>Binder的完整定义</h3><ul>
<li>从进程间通信的角度看，Binder是一种进程间通信的机制；</li>
<li>从Server进程角度看，Binder指的是Server中的Binder实体对象；</li>
<li>从Clent进程的角度看，Binder指的是对Binder代理对象，是Binder实体对象的一个远程代理。</li>
<li>从传输过程的角度看，Binder是一个可以跨进程传输的对象；Binder驱动会对这个跨越进程的对象做一点点特殊处理，自动完成代理对象和本地对象之间的转换。</li>
</ul>
<h2 id="五、手动编码实现跨进程调用"><a href="#五、手动编码实现跨进程调用" class="headerlink" title="五、手动编码实现跨进程调用"></a>五、手动编码实现跨进程调用</h2><ul>
<li>IBinder：IBinder是一个接口，代表了一种跨进程的能力。只要实现了这个接口，这个对象就能跨进程传输。</li>
<li>IInterface: IInterface代表的是Server进程对象具备什么能力</li>
<li>Binder：java层的Binder类，代表队额其实就是Binder本地对象。BinderProxy类是Binder类的一个内部类，它代表远程进程的Binder对象的本地代理；这两个类都继承自IBinder，因而都具有跨进程传输的能力；实际上，在跨进程的视乎，Binder驱动会自动完成这两个对象的转换。</li>
<li>Stub：<br>AIDL的时候，编译工具会给我们生成一个名为Stub的静态内部类，这个类继承了Binder，说明它是一个Binder本地对象，它实现了Interface接口，表明它具有Server承诺给Client的能力；Stub是一个抽象类，具体的IIterface的相关实现需要开发者自己实现。</li>
</ul>
<p>##五、总结</p>
<ul>
<li>Binder使用了面向对象的思想来描述作为访问接入点的Binder及其在Client中的入口。Binder是一个实体位于Server中的对象，该对象提供了一套方法用以实现对服务的请求，如同类的成员函数。面向对象思想的引入将进程间通信转化为通过对某个Binder对象的引用调用该对象的方法，而其独特之处在于Binder对象是一个可以跨进程引用的对象，他的实体位于一个进程中，而它的引用却遍布于系统给的各个进程中。这个引用和java中的引用一样既可以是强引用也可以是弱类型，而且可以从一个进程传给其他进程，让大家都能访问同意server，就像讲一个对象或引用赋值给另一个引用一样。Binder模糊了进程边界，淡化了进程间通信过程，整个系统仿佛运行与同一个面向对象的程序之中。形形色色的Binder对象以及星罗密布的引用仿佛粘接各个应用程序的胶水，这也是Binder在英文里的原意。（<strong>当然面向对象只是针对应用程序而言，对于Binder驱动和内核其它模块一样使用C语言实现，没有类和对象的概念。Binder驱动为面向对象的进程间通信提供底层支持</strong>。）</li>
</ul>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/16/仿bugtags实现App线上Crash监控及问题复现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="吴晓龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://opq81riyh.bkt.clouddn.com/666.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓龙">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/16/仿bugtags实现App线上Crash监控及问题复现/" itemprop="url">仿bugtags实现App线上Crash监控及问题复现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-16T21:15:18+08:00">
                2018-03-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index">
                    <span itemprop="name">android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="仿bugtags实现App线上Crash监控及问题复现"><a href="#仿bugtags实现App线上Crash监控及问题复现" class="headerlink" title="仿bugtags实现App线上Crash监控及问题复现"></a>仿bugtags实现App线上Crash监控及问题复现</h1><h1 id="实现线上crash监控，包含了手机堆栈信息和设备信息，及时上传，后台修复并启用推送进行热修复流程，重要的是要手机用户的使用步骤及现场截屏，以便更快的复现问题。"><a href="#实现线上crash监控，包含了手机堆栈信息和设备信息，及时上传，后台修复并启用推送进行热修复流程，重要的是要手机用户的使用步骤及现场截屏，以便更快的复现问题。" class="headerlink" title="实现线上crash监控，包含了手机堆栈信息和设备信息，及时上传，后台修复并启用推送进行热修复流程，重要的是要手机用户的使用步骤及现场截屏，以便更快的复现问题。"></a>实现线上crash监控，包含了手机堆栈信息和设备信息，及时上传，后台修复并启用推送进行热修复流程，重要的是要手机用户的使用步骤及现场截屏，以便更快的复现问题。</h1><p>大致的流程如下：<br><img src="https://user-gold-cdn.xitu.io/2018/3/16/1622ef553a189001?w=1050&amp;h=478&amp;f=png&amp;s=26046" alt=""></p>
<h2 id="下面按照项目的实现过程介绍怎么具体实现发生fc之后及时上传。"><a href="#下面按照项目的实现过程介绍怎么具体实现发生fc之后及时上传。" class="headerlink" title="下面按照项目的实现过程介绍怎么具体实现发生fc之后及时上传。"></a>下面按照项目的实现过程介绍怎么具体实现发生fc之后及时上传。</h2><h2 id="1、首先初始化BugMonitor工具BugMonitor-init-this-及小米推送MiPushClient-registerPush-this-APP-ID-APP-KEY-和文件上传的工具Bmob-initialize-this-BMOB-APPID-（其实小米推送和文件上传可以自己后台实现，我是因为个人没有服务器，用的免费推送和文件存储服务，在此谢谢这些sdk公司）"><a href="#1、首先初始化BugMonitor工具BugMonitor-init-this-及小米推送MiPushClient-registerPush-this-APP-ID-APP-KEY-和文件上传的工具Bmob-initialize-this-BMOB-APPID-（其实小米推送和文件上传可以自己后台实现，我是因为个人没有服务器，用的免费推送和文件存储服务，在此谢谢这些sdk公司）" class="headerlink" title="1、首先初始化BugMonitor工具BugMonitor.init(this);及小米推送MiPushClient.registerPush(this, APP_ID, APP_KEY);和文件上传的工具Bmob.initialize(this,BMOB_APPID);（其实小米推送和文件上传可以自己后台实现，我是因为个人没有服务器，用的免费推送和文件存储服务，在此谢谢这些sdk公司）"></a>1、首先初始化BugMonitor工具BugMonitor.init(this);及小米推送MiPushClient.registerPush(this, APP_ID, APP_KEY);和文件上传的工具Bmob.initialize(this,BMOB_APPID);（其实小米推送和文件上传可以自己后台实现，我是因为个人没有服务器，用的免费推送和文件存储服务，在此谢谢这些sdk公司）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">   public void onCreate() &#123;</span><br><span class="line">       super.onCreate();</span><br><span class="line">       BugMonitor.init(this);</span><br><span class="line">       Bmob.initialize(this,BMOB_APPID);</span><br><span class="line">       MiPushClient.registerPush(this, APP_ID, APP_KEY);</span><br><span class="line">       LoggerInterface newLogger = new LoggerInterface() &#123;</span><br><span class="line">           @Override</span><br><span class="line">           public void setTag(String tag) &#123;</span><br><span class="line">               // ignore</span><br><span class="line">           &#125;</span><br><span class="line">           @Override</span><br><span class="line">           public void log(String content, Throwable t) &#123;</span><br><span class="line">               Log.d(TAG, &quot;----&gt;&gt;t&quot;+content, t);</span><br><span class="line">           &#125;</span><br><span class="line">           @Override</span><br><span class="line">           public void log(String content) &#123;</span><br><span class="line">               Log.d(TAG, &quot;----&gt;&gt;content&quot;+content);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;;</span><br><span class="line">       Logger.setLogger(this, newLogger);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h2 id="2、在BugMonitor中初始化CrashHandler-因为安卓中可以通过这个Handler来捕捉crash信息"><a href="#2、在BugMonitor中初始化CrashHandler-因为安卓中可以通过这个Handler来捕捉crash信息" class="headerlink" title="2、在BugMonitor中初始化CrashHandler,因为安卓中可以通过这个Handler来捕捉crash信息"></a>2、在BugMonitor中初始化CrashHandler,因为安卓中可以通过这个Handler来捕捉crash信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public static void init(Context context) &#123;</span><br><span class="line">        mContext = context;</span><br><span class="line">        initCrashHandler(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void initCrashHandler(Context context) &#123;</span><br><span class="line">        Thread.UncaughtExceptionHandler exceptionHandler = Thread.getDefaultUncaughtExceptionHandler();</span><br><span class="line">        CrashHandler crashHandler = new CrashHandler(context, exceptionHandler);</span><br><span class="line">        Thread.setDefaultUncaughtExceptionHandler(crashHandler);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="3、CrashHandler-实现了-Thread-UncaughtExceptionHandler接口，并在uncaughtException方法中获取发生crash时的堆栈信息。"><a href="#3、CrashHandler-实现了-Thread-UncaughtExceptionHandler接口，并在uncaughtException方法中获取发生crash时的堆栈信息。" class="headerlink" title="3、CrashHandler 实现了 Thread.UncaughtExceptionHandler接口，并在uncaughtException方法中获取发生crash时的堆栈信息。"></a>3、CrashHandler 实现了 Thread.UncaughtExceptionHandler接口，并在uncaughtException方法中获取发生crash时的堆栈信息。</h2><h2 id="4、当发生crash的时候我们需要做的就是尽量收集有用的信息-下面我们仔细看下onCrash方法。"><a href="#4、当发生crash的时候我们需要做的就是尽量收集有用的信息-下面我们仔细看下onCrash方法。" class="headerlink" title="4、当发生crash的时候我们需要做的就是尽量收集有用的信息,下面我们仔细看下onCrash方法。"></a>4、当发生crash的时候我们需要做的就是尽量收集有用的信息,下面我们仔细看下onCrash方法。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">    public void onCrash(String crashInfo) &#123;</span><br><span class="line">        Activity activity = ActivityHelper.getActivity();</span><br><span class="line">        long mills = System.currentTimeMillis();</span><br><span class="line">        dirName = TIME_FORMATTER.format(mills);</span><br><span class="line"></span><br><span class="line">        Display defaultDisplay = activity.getWindowManager().getDefaultDisplay();</span><br><span class="line">        Point point = new Point();</span><br><span class="line">        defaultDisplay.getSize(point);</span><br><span class="line">        float density = activity.getResources().getDisplayMetrics().density;</span><br><span class="line"></span><br><span class="line">        String networkState = NetUtil.getNetworkState(BugMonitor.mContext);</span><br><span class="line">        PackageInfo info = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            info = BugMonitor.mContext.getPackageManager().getPackageInfo(BugMonitor.mContext.getPackageName(), 0);</span><br><span class="line">        &#125; catch (PackageManager.NameNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        long freeMemory = MemoryUtil.getFreeMemory();</span><br><span class="line">        long totalMemory = MemoryUtil.getTotalMemory();</span><br><span class="line">        String cpuName = CPUUtil.getCpuName();</span><br><span class="line">        String curCpuFreq = CPUUtil.getCurCpuFreq();</span><br><span class="line">        String maxCpuFreq = CPUUtil.getMaxCpuFreq();</span><br><span class="line">        String minCpuFreq = CPUUtil.getMinCpuFreq();</span><br><span class="line">        int numCores = CPUUtil.getNumCores();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        boolean rooted = SystemInfoUtil.checkSuFile();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        activity.getWindow().getDecorView().setDrawingCacheEnabled(true);</span><br><span class="line">        Bitmap bmp = activity.getWindow().getDecorView().getDrawingCache();</span><br><span class="line">        BitmapHelper.saveBitmap(bmp, dirName);</span><br><span class="line">        final String s = CrashInfo.newInstance()</span><br><span class="line">                .setStackStrings(crashInfo)</span><br><span class="line">                .setScreenResolution(point)</span><br><span class="line">                .setDensity(density)</span><br><span class="line">                .setNetwork(networkState)</span><br><span class="line">                .setPackageInfo(info)</span><br><span class="line">                .setMemory(freeMemory,totalMemory)</span><br><span class="line">                .setCpuInfo(numCores,cpuName,curCpuFreq,maxCpuFreq)</span><br><span class="line">                .setIsRoot(rooted)</span><br><span class="line">                .flushString()</span><br><span class="line">                .toString();</span><br><span class="line">        saveLogToSDCard(s,&quot;crashInfo&quot;);</span><br><span class="line">        String step = StepQueueHelper.flushString();</span><br><span class="line">        Log.e(TAG, &quot;----&gt;&gt;step: &quot;+step );</span><br><span class="line">        saveLogToSDCard(step,&quot;step&quot;);</span><br><span class="line">        Log.e(TAG, s );</span><br><span class="line"></span><br><span class="line">        //1、将文件夹目录写入sp中，再次启动时读出其中的内容</span><br><span class="line">        //2、特殊情况：已启动就fc，根本来不及上传</span><br><span class="line">        Intent intent = new Intent(activity, UploadService.class);</span><br><span class="line">        activity.startService(intent);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="5、首先我们获取当前的activity，截下当前界面的图片，并收集收集系统版本，api，屏幕分辨率，屏幕密度，内存情况，网络情况，cpu，是否root过等等信息，并通过一个Builder模式构建出一个String。同时，将用户的使用步骤队列输出为一个String。（这部分是核心，大家可以看代码https-github-com-lantier743865-kso）"><a href="#5、首先我们获取当前的activity，截下当前界面的图片，并收集收集系统版本，api，屏幕分辨率，屏幕密度，内存情况，网络情况，cpu，是否root过等等信息，并通过一个Builder模式构建出一个String。同时，将用户的使用步骤队列输出为一个String。（这部分是核心，大家可以看代码https-github-com-lantier743865-kso）" class="headerlink" title="5、首先我们获取当前的activity，截下当前界面的图片，并收集收集系统版本，api，屏幕分辨率，屏幕密度，内存情况，网络情况，cpu，是否root过等等信息，并通过一个Builder模式构建出一个String。同时，将用户的使用步骤队列输出为一个String。（这部分是核心，大家可以看代码https://github.com/lantier743865/kso）"></a>5、首先我们获取当前的activity，截下当前界面的图片，并收集收集系统版本，api，屏幕分辨率，屏幕密度，内存情况，网络情况，cpu，是否root过等等信息，并通过一个Builder模式构建出一个String。同时，将用户的使用步骤队列输出为一个String。（这部分是核心，大家可以看代码<a href="https://github.com/lantier743865/kso）" target="_blank" rel="noopener">https://github.com/lantier743865/kso）</a></h2><p>##6、关于使用步骤我们要看一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">package android.com.bugmonitor.base;</span><br><span class="line"></span><br><span class="line">import android.com.bugmonitor.collector.BugMonitor;</span><br><span class="line">import android.support.v7.app.AppCompatActivity;</span><br><span class="line">import android.util.Log;</span><br><span class="line">import android.view.MotionEvent;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by wuxiaolong on 2018/3/9.</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">public class BaseActivity extends AppCompatActivity &#123;</span><br><span class="line">    private static final String TAG = &quot;BaseActivity&quot;;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onResume() &#123;</span><br><span class="line">        super.onResume();</span><br><span class="line">        BugMonitor.onResume(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onPause() &#123;</span><br><span class="line">        super.onPause();</span><br><span class="line">        BugMonitor.onPause(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean dispatchTouchEvent(MotionEvent ev) &#123;</span><br><span class="line">        BugMonitor.onDispatchTouchEvent(this,ev);</span><br><span class="line">        return super.dispatchTouchEvent(ev);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="在这BaseActivity中我们记录了每个界面的进入退出，及事件分发情况。我们重点看事件这部分，因为这部分会找到对应的view的id。"><a href="#在这BaseActivity中我们记录了每个界面的进入退出，及事件分发情况。我们重点看事件这部分，因为这部分会找到对应的view的id。" class="headerlink" title="在这BaseActivity中我们记录了每个界面的进入退出，及事件分发情况。我们重点看事件这部分，因为这部分会找到对应的view的id。"></a>在这BaseActivity中我们记录了每个界面的进入退出，及事件分发情况。我们重点看事件这部分，因为这部分会找到对应的view的id。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">   public void onDispatchTouchEvent(Activity activity, MotionEvent event) &#123;</span><br><span class="line">       if(event.getAction() == 0) &#123;</span><br><span class="line">           this.lastX = event.getRawX();</span><br><span class="line">           this.lastY = event.getRawY();</span><br><span class="line">       &#125; else if(event.getAction() == 1) &#123;</span><br><span class="line">           float currentX = event.getRawX();</span><br><span class="line">           float currentY = event.getRawY();</span><br><span class="line">           if(this.lastX == currentX &amp;&amp; this.lastY == currentY) &#123;</span><br><span class="line">               View var5 = this.getView(activity.getWindow().getDecorView(), currentX, currentY);</span><br><span class="line">               Log.e(TAG, &quot;----&gt;&gt;var5: &quot;+var5 );</span><br><span class="line">               StepQueueHelper.enqueueStep(activity,var5);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>##其实，我们在获取到event后，可以通过当前的activity的decorView的位置算出当前是哪个view，这一点我也是从bugtags的源码看出来的，可以混淆过我看了半天才想明白。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public static void enqueueStep(Activity activity, View view) &#123;</span><br><span class="line">        String path  = view.getResources().getResourceName(view.getId());</span><br><span class="line">        String vName = path.substring(path.indexOf(&quot;/&quot;)+1);</span><br><span class="line">        String format = TIME_FORMATTER.format(System.currentTimeMillis());</span><br><span class="line">        stepBuilder.append(format)</span><br><span class="line">                .append(SPACE)</span><br><span class="line">                .append(activity.getClass().getName())</span><br><span class="line">                .append(SPACE)</span><br><span class="line">                .append(EVENT)</span><br><span class="line">                .append(VIEWID)</span><br><span class="line">                .append(vName)</span><br><span class="line">                .append(SPACE)</span><br><span class="line">                .append(TYPE)</span><br><span class="line">                .append(view.getClass().getName());</span><br><span class="line">        String s = stepBuilder.toString();</span><br><span class="line">        stepQueue.add(s);</span><br><span class="line">        stepBuilder.delete(0,stepBuilder.length());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="有了view我们可以通过R文件获取它在我们项目中设置的id名称，这有助于我们找到对应的发生问题的空间。代码中一系列append是为了打印出来的信息格式化更容易分辨。"><a href="#有了view我们可以通过R文件获取它在我们项目中设置的id名称，这有助于我们找到对应的发生问题的空间。代码中一系列append是为了打印出来的信息格式化更容易分辨。" class="headerlink" title="有了view我们可以通过R文件获取它在我们项目中设置的id名称，这有助于我们找到对应的发生问题的空间。代码中一系列append是为了打印出来的信息格式化更容易分辨。"></a>有了view我们可以通过R文件获取它在我们项目中设置的id名称，这有助于我们找到对应的发生问题的空间。代码中一系列append是为了打印出来的信息格式化更容易分辨。</h2><h2 id="6、还有关键的一步时应用要挂掉了，怎么把信息传到服务端去？答案是另开一个service-在其他进程中"><a href="#6、还有关键的一步时应用要挂掉了，怎么把信息传到服务端去？答案是另开一个service-在其他进程中" class="headerlink" title="6、还有关键的一步时应用要挂掉了，怎么把信息传到服务端去？答案是另开一个service(在其他进程中)"></a>6、还有关键的一步时应用要挂掉了，怎么把信息传到服务端去？答案是另开一个service(在其他进程中)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = new Intent(activity, UploadService.class);</span><br><span class="line">        activity.startService(intent);</span><br></pre></td></tr></table></figure>
<p>#关于BugMonitor关键的部分讲完了，剩下的就是代码编写和实现了。</p>
<p>#其中upload是一个接口，大家可以用自己的服务器规范去实现，我个人用了bmob的免费存储。大致的目录结构是这样的：<br><img src="https://user-gold-cdn.xitu.io/2018/3/16/1622ef5539893405?w=716&amp;h=1396&amp;f=png&amp;s=176242" alt=""></p>
<h2 id="7、我们看下最终的结果："><a href="#7、我们看下最终的结果：" class="headerlink" title="7、我们看下最终的结果："></a>7、我们看下最终的结果：</h2><p><img src="https://user-gold-cdn.xitu.io/2018/3/16/1622ef553ae81098?w=2664&amp;h=552&amp;f=png&amp;s=320254" alt=""></p>
<p>###这是携带设备信息的堆栈信息文件<br><img src="https://user-gold-cdn.xitu.io/2018/3/16/1622ef553a8c5018?w=2730&amp;h=868&amp;f=png&amp;s=381825" alt=""></p>
<p>###这是用户的使用步骤文件<br><img src="https://user-gold-cdn.xitu.io/2018/3/16/1622ef553adb3187?w=2204&amp;h=372&amp;f=png&amp;s=158186" alt=""></p>
<p>###这是最终上传到服务端后的文件<br><img src="https://user-gold-cdn.xitu.io/2018/3/16/1622ef553a3bd560?w=2038&amp;h=952&amp;f=png&amp;s=202924" alt=""></p>
<p>###这是发生crash时候的现场截屏<br><img src="https://user-gold-cdn.xitu.io/2018/3/16/1622ef55746956fe?w=1962&amp;h=1638&amp;f=png&amp;s=160631" alt=""></p>
<h1 id="最后总结："><a href="#最后总结：" class="headerlink" title="最后总结："></a>最后总结：</h1><ol>
<li>工具是为了发生某些crash之后我们尽可能的多收集现场信息</li>
<li>mipush和bmob是为了流程能够完善，最终我们还需要热修复来善后</li>
<li>代码地址：![<a href="https://github.com/lantier743865/kso" target="_blank" rel="noopener">https://github.com/lantier743865/kso</a>]</li>
<li>写的不好，大家请见谅，以后会继续努力。</li>
</ol>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/01/快速排序/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="吴晓龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://opq81riyh.bkt.clouddn.com/666.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓龙">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/01/快速排序/" itemprop="url">快速排序</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-01T20:15:14+08:00">
                2018-03-01
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 快速排序是用分治策略</span></span><br><span class="line"><span class="comment"> * 基本思想：选择一个基准数，通过一趟排序将要排序的数据分割成独立的两部分；</span></span><br><span class="line"><span class="comment"> *          其中一部分的所有数据都比另外一部分的所有数据都小。</span></span><br><span class="line"><span class="comment"> *          然后，再按此方法对这两部分数据分别进行快速排序，</span></span><br><span class="line"><span class="comment"> *          整个排序过程可以递归进行，以此达到整个数据变成有序序列。</span></span><br><span class="line"><span class="comment"> * 快速排序的流程：</span></span><br><span class="line"><span class="comment"> * 1、从数列中挑出一个基准值</span></span><br><span class="line"><span class="comment"> * 2、将所有比基准值小的摆放在基准前面，所有比基准值大的摆在基准的后面（相同的数可以到任一边）；</span></span><br><span class="line"><span class="comment"> *    在这个区分退出后，该基准就处于数列的中间位置</span></span><br><span class="line"><span class="comment"> * 3、递归的把"基准前面的子数列"和"基准值后面的子数列"进行排序</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 快速排序的事件复杂度和稳定性</span></span><br><span class="line"><span class="comment"> *  快速排序是不稳定的算法，它不满足稳定算法的定义。</span></span><br><span class="line"><span class="comment"> *  快速排序的时间复杂度在最坏的情况下是O(N^2),平均时间复杂度是O(N*lgN)</span></span><br><span class="line"><span class="comment"> *  快速排序采用分治法进行便利，我们将它看作一颗二叉树，它要遍历的次数就是二叉树的深度，</span></span><br><span class="line"><span class="comment"> *  根据完全二叉树的定义，他的深度至少是lg(N+1)，因此，快速排序的遍历次数最少是lg(N+1)次</span></span><br><span class="line"><span class="comment"> *  二叉树的最大深度是N，因此，快速排序的便利次数最多是N次。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickSort</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> input 待排序的数组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> left 数组的左边界</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> right 数组的右边界</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(<span class="keyword">int</span>[] input,<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (left &lt; right) &#123;</span><br><span class="line">            <span class="keyword">int</span> i,j,x;</span><br><span class="line">            i = left;</span><br><span class="line">            j = right;</span><br><span class="line">            x = input[i];</span><br><span class="line">            <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">                <span class="comment">//从右向左找第一个小于x的数</span></span><br><span class="line">                <span class="keyword">while</span> (i &lt; j &amp;&amp; x&lt;input[j]) &#123;</span><br><span class="line">                    j--;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">                    input[i++] = input[j];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//从左向右找第一个大于x的数</span></span><br><span class="line">                <span class="keyword">while</span> (i &lt; j &amp;&amp; x &gt; input[i] )&#123;</span><br><span class="line">                    i++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">                    input[j--] = input[i];</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            input[i] = x;</span><br><span class="line">            <span class="comment">//递归调用</span></span><br><span class="line">            quickSort(input,left,i -<span class="number">1</span>);</span><br><span class="line">            quickSort(input,i+<span class="number">1</span>,right);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] input = &#123;<span class="number">50</span>,<span class="number">30</span>,<span class="number">25</span>,<span class="number">80</span>,<span class="number">234</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">873</span>&#125;;</span><br><span class="line">        quickSort(input,<span class="number">0</span>,input.length-<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; input.length; i++) &#123;</span><br><span class="line">            System.out.print(input[i] +<span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/26/栈/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="吴晓龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://opq81riyh.bkt.clouddn.com/666.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓龙">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/26/栈/" itemprop="url">栈</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-26T16:50:29+08:00">
                2018-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.regexp.internal.RE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneralArrayStack</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_SIZE = <span class="number">12</span>;</span><br><span class="line">    <span class="keyword">private</span> T[] mArray;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GeneralArrayStack</span><span class="params">(Class&lt;T&gt; type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(type,DEFAULT_SIZE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GeneralArrayStack</span><span class="params">(Class&lt;T&gt; type, <span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">         mArray = (T[]) Array.newInstance(type, size);</span><br><span class="line">         count = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//将val添加到栈中</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(T val)</span></span>&#123;</span><br><span class="line">        mArray[count++] = val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回栈顶元素值</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">peek</span> <span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mArray[count-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回栈顶元素，并删除栈顶元素</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">pop</span><span class="params">()</span></span>&#123;</span><br><span class="line">        T ret = mArray[count - <span class="number">1</span>];</span><br><span class="line">        count--;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回栈大小</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回栈是否为空</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size() == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//打印栈</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PrintArrayStack</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            System.out.println(<span class="string">"stack is Empty \n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        System.out.print("stack size() = d% \n" ,size());</span></span><br><span class="line">        <span class="keyword">int</span> i = size() -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            System.out.println(mArray[i]);</span><br><span class="line">            i--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/26/双向链表/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="吴晓龙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://opq81riyh.bkt.clouddn.com/666.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓龙">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/26/双向链表/" itemprop="url">双向链表</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-26T16:09:01+08:00">
                2018-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 双向链表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoubleLink</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">//表头</span></span><br><span class="line">    <span class="keyword">private</span> DNode&lt;T&gt; mHead;</span><br><span class="line">    <span class="comment">//节点个数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mCount;</span><br><span class="line">    <span class="comment">//双向链表"节点"对应的结构体</span></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">DNode</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> DNode prev;</span><br><span class="line">        <span class="keyword">public</span> DNode next;</span><br><span class="line">        <span class="keyword">public</span> T value;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">DNode</span><span class="params">(T value, DNode prev, DNode next)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.value = value;</span><br><span class="line">            <span class="keyword">this</span>.prev = prev;</span><br><span class="line">            <span class="keyword">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DoubleLink</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//创建表头，表头没有存储数据</span></span><br><span class="line">        mHead = <span class="keyword">new</span> DNode&lt;T&gt;(<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="keyword">null</span>);</span><br><span class="line">        mHead.prev = mHead.next = mHead;</span><br><span class="line">        mCount = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回节点数目</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mCount;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回链表是否为空</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mCount == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取第index位置的节点</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> DNode&lt;T&gt; <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= mCount) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//正向查找</span></span><br><span class="line">        <span class="keyword">if</span> (index &lt;= mCount / <span class="number">2</span>)&#123;</span><br><span class="line">            DNode&lt;T&gt; node = mHead.next;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">                node = node.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//反向查找</span></span><br><span class="line">        DNode&lt;T&gt; rnode = mHead.prev;</span><br><span class="line">        <span class="keyword">int</span> rindex = mCount - index - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rindex; i++) &#123;</span><br><span class="line">            rnode = rnode.prev;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rnode;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取index位置的节点的值</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getNode(index).value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取第一个节点的值</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getFirst</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getNode(<span class="number">0</span>).value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取最后一个节点的值</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getLast</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getNode(mCount - <span class="number">1</span>).value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//将节点插入到第index位置之前</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> index, T t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>)&#123;</span><br><span class="line">            DNode&lt;T&gt; dNode = <span class="keyword">new</span> DNode&lt;&gt;(t, mHead, mHead.next);</span><br><span class="line">            mHead.next.prev = dNode;</span><br><span class="line">            mHead.next = dNode;</span><br><span class="line">            mCount++;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//先获取到当前位置的节点</span></span><br><span class="line">        DNode&lt;T&gt; inode = getNode(index);</span><br><span class="line">        <span class="comment">//创建这个节点，这个节点之后是当前位置的节点，这个节点之前是当前位置节点之前的节点</span></span><br><span class="line">        DNode&lt;T&gt; tNode = <span class="keyword">new</span> DNode&lt;&gt;(t, inode.prev, inode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//以下两步是因为是双向链表，所以要两边都指定</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//将当前位置的节点的上一个节点的next指向要插入的节点</span></span><br><span class="line">        inode.prev.next = tNode;</span><br><span class="line">        <span class="comment">//将当前位置的节点的下一个节点指向要插入的节点</span></span><br><span class="line">        inode.next = tNode;</span><br><span class="line">        mCount++;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//将节点插入第一个 节点处</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertFirst</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">        insert(<span class="number">0</span>,t);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//将节点追加到链表的末尾</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">appendLast</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">        DNode&lt;T&gt; tNode = <span class="keyword">new</span> DNode&lt;&gt;(t, mHead.prev, mHead);</span><br><span class="line">        mHead.prev.next = tNode;</span><br><span class="line">        mHead.prev = tNode;</span><br><span class="line">        mCount++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//删除index位置的节点</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">        DNode&lt;T&gt; node = getNode(index);</span><br><span class="line">        node.prev.next = node.next;</span><br><span class="line">        node.next.prev = node.prev;</span><br><span class="line">        node = <span class="keyword">null</span>;</span><br><span class="line">        mCount--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//删除第一个节点</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteFirst</span><span class="params">()</span></span>&#123;</span><br><span class="line">        del(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteLast</span><span class="params">()</span></span>&#123;</span><br><span class="line">        del(mCount - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="http://opq81riyh.bkt.clouddn.com/666.jpg" alt="吴晓龙">
            
              <p class="site-author-name" itemprop="name">吴晓龙</p>
              <p class="site-description motion-element" itemprop="description">耐得住寂寞 守得住繁华</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">26</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lantier743865" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/3166661920/profile?topnav=1&wvr=6" target="_blank" title="微博">
                      
                        <i class="fa fa-fw fa-globe"></i>微博</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/user/58c9e40b61ff4b006c808011" target="_blank" title="掘金">
                      
                        <i class="fa fa-fw fa-globe"></i>掘金</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.jianshu.com/u/218df555dee7" target="_blank" title="简书">
                      
                        <i class="fa fa-fw fa-globe"></i>简书</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">吴晓龙</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>